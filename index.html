<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BK Rest Inventory</title>
  <style>
    :root{
      --bg:#0b1220;
      --card:#0f1a2e;
      --card2:#0c1526;
      --text:#e7eefc;
      --muted:#9bb0d0;
      --line:rgba(255,255,255,.08);
      --accent:#5eead4;
      --ok:#16a34a;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: radial-gradient(1200px 600px at 70% -10%, rgba(94,234,212,.12), transparent 60%),
                  radial-gradient(900px 500px at 10% 0%, rgba(99,102,241,.10), transparent 55%),
                  var(--bg);
      color:var(--text);
    }
    .wrap{max-width:1100px;margin:0 auto;padding:18px}
    h1{margin:6px 0 4px;font-size:28px;letter-spacing:.3px}
    .sub{margin:0 0 14px;color:var(--muted)}
    .toolbar{
      display:flex;gap:10px;flex-wrap:wrap;align-items:center;
      background:rgba(255,255,255,.04);
      border:1px solid var(--line);
      border-radius:14px;
      padding:10px 12px;
      margin-bottom:14px;
    }
    .toolbar input{
      flex:1;
      min-width:220px;
      background:rgba(0,0,0,.25);
      border:1px solid var(--line);
      color:var(--text);
      border-radius:12px;
      padding:10px 12px;
      outline:none;
    }
    .btn{
      background:rgba(94,234,212,.12);
      border:1px solid rgba(94,234,212,.25);
      color:var(--text);
      border-radius:12px;
      padding:10px 12px;
      cursor:pointer;
      user-select:none;
    }
    .btn:active{transform:translateY(1px)}
    .grid{
      background:rgba(255,255,255,.03);
      border:1px solid var(--line);
      border-radius:16px;
      overflow:hidden;
    }
    table{width:100%;border-collapse:separate;border-spacing:0}
    thead th{
      text-align:left;
      font-weight:600;
      color:var(--muted);
      font-size:12px;
      letter-spacing:.4px;
      padding:12px 10px;
      background:rgba(255,255,255,.04);
      border-bottom:1px solid var(--line);
      position:sticky;top:0;backdrop-filter: blur(6px);
      z-index:2;
    }
    tbody td{
      padding:10px;
      border-bottom:1px solid var(--line);
      vertical-align:middle;
    }
    tbody tr:nth-child(odd){background:rgba(255,255,255,.015)}
    .nr{width:70px;color:var(--muted)}
    .sizes{color:var(--muted);font-variant-numeric:tabular-nums}
    .qty input{
      width:90px;
      background:rgba(0,0,0,.25);
      border:1px solid var(--line);
      color:var(--text);
      border-radius:10px;
      padding:8px 10px;
      outline:none;
      font-variant-numeric:tabular-nums;
    }
    .qty input:focus{border-color:rgba(94,234,212,.35)}
    .gesamt{
      width:120px;
      text-align:right;
      font-variant-numeric:tabular-nums;
      font-weight:700;
      color:#d8ffe9;
      background:rgba(22,163,74,.10);
      border-left:1px solid var(--line);
    }
    .right{text-align:right}
    .muted{color:var(--muted)}
    .foot{
      display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between;
      margin-top:12px;color:var(--muted);font-size:12px;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>BK Rest Inventory</h1>
    <p class="sub">Daily inventory: <span class="muted">Karton + Beutel + Stück → Gesamt</span></p>

    <div class="toolbar">
      <input id="search" placeholder="Search item (e.g. Nuggets, Tomaten, Brioche)..." />
      <button class="btn" id="clear">Clear all</button>
      <button class="btn" id="reset">Reset to 0</button>
    </div>

    <div class="grid">
      <table>
        <thead>
          <tr>
            <th class="nr">Nr.</th>
            <th>Item</th>
            <th class="right">Karton size</th>
            <th class="right">Karton qty</th>
            <th class="right">Beutel size</th>
            <th class="right">Beutel qty</th>
            <th class="right">Stück</th>
            <th class="right">Gesamt</th>
          </tr>
        </thead>
        <tbody id="rows"></tbody>
      </table>
    </div>

    <div class="foot">
      <div>Tip: quantities are remembered in your browser (local storage).</div>
      <div id="count"></div>
    </div>
  </div>

<script>
  // === FULL LIST (from your Tagesinventur sheet) ===
  const ITEMS = [
    { nr: 10,   name: "Whopper BUN",               karton: 20,   beutel: 30 },
    { nr: 20,   name: "Burger BUN",                karton: 60,   beutel: 48 },
    { nr: 39,   name: "Long BUN",                  karton: 48,   beutel: 32 },
    { nr: 43,   name: "Long Chicken Patty",        karton: 112,  beutel: 14 },
    { nr: 50,   name: "Whopper Patty",             karton: 132,  beutel: 50 },
    { nr: 53,   name: "Crispy Chicken Patty",      karton: 136,  beutel: 17 },
    { nr: 55,   name: "Burger Patty",              karton: 312,  beutel: 65 },
    { nr: 56,   name: "King Wings",                karton: 325,  beutel: 65 },
    { nr: 57,   name: "King Nuggets",              karton: 568,  beutel: 71 },
    { nr: 60,   name: "Bacon",                     karton: 930,  beutel: 155, stueckSize: 52 },
    { nr: 100,  name: "Pommes Frites",             karton: 12.5, beutel: 2.5 },
    { nr: 107,  name: "Zwiebelringe",              karton: 630,  beutel: 63 },
    { nr: 122,  name: "Hot Brownie",               karton: 18,   beutel: 0 },
    { nr: 129,  name: "Hot Blondie",               karton: 18,   beutel: 0 },
    { nr: 606,  name: "Chilli Cheese Nuggets",     karton: 450,  beutel: 50 },

    // kg items (keep both columns, as on sheet)
    { nr: 910,  name: "Tomaten (kg)",              karton: 5,    beutel: 5 },
    { nr: 912,  name: "Zwiebeln (kg)",             karton: 20,   beutel: 1.5 },
    { nr: 916,  name: "Eisbergsalat (kg)",         karton: 6,    beutel: 1 },

    { nr: 11577, name: "Mozzarella Sticks",        karton: 204,  beutel: 34 },
    { nr: 11816, name: "Chicken Tender Strips",    karton: 216,  beutel: 27 },
    { nr: 11866, name: "Gitterpommes",             karton: 10,   beutel: 2.5 },
    { nr: 11869, name: "Tortilla Wrap",            karton: 144,  beutel: 18 },
    { nr: 11900, name: "Potato Bun",               karton: 48,   beutel: 24 },
    { nr: 11947, name: "PlantBased WH Patty",      karton: 100,  beutel: 0 },
    { nr: 11973, name: "PlantBased Nuggets",       karton: 568,  beutel: 71 },
    { nr: 12010, name: "PlantBased HB Patty",      karton: 200,  beutel: 0 },
    { nr: 12029, name: "PlantBased Long Patty",    karton: 112,  beutel: 14 },
    { nr: 12055, name: "Brioche BUN",              karton: 30,   beutel: 15 },
    { nr: 12061, name: "Premium Crunchy Chicken",  karton: 96,   beutel: 12 },
    { nr: 12110, name: "Mini Churros",             karton: 500,  beutel: 100 },
    { nr: 12180, name: "Falafel Bites",            karton: 249,  beutel: 83 }
  ];

  const LS_KEY = "bk_rest_inventory_v1";
  const state = loadState();

  const tbody = document.getElementById("rows");
  const search = document.getElementById("search");
  const countEl = document.getElementById("count");

  function loadState(){
    try{
      const raw = localStorage.getItem(LS_KEY);
      return raw ? JSON.parse(raw) : {};
    }catch(e){
      return {};
    }
  }
  function saveState(){
    localStorage.setItem(LS_KEY, JSON.stringify(state));
  }

  function n(v){
    const x = Number(String(v).replace(",", "."));
    return Number.isFinite(x) ? x : 0;
  }

  function calcGesamt(item){
    const s = state[item.nr] || {};
    const kartonQty = n(s.kartonQty);
    const beutelQty = n(s.beutelQty);
    const stueck    = n(s.stueck);

    const stueckSize = item.stueckSize ? n(item.stueckSize) : 1;

    return (kartonQty * n(item.karton)) + (beutelQty * n(item.beutel)) + (stueck * stueckSize);
  }

  function render(filterText=""){
    tbody.innerHTML = "";
    const ft = filterText.trim().toLowerCase();

    const filtered = ITEMS.filter(it => {
      if(!ft) return true;
      return (String(it.nr).includes(ft) || it.name.toLowerCase().includes(ft));
    });

    countEl.textContent = `${filtered.length} / ${ITEMS.length} items`;

    for(const item of filtered){
      if(!state[item.nr]) state[item.nr] = { kartonQty: 0, beutelQty: 0, stueck: 0 };

      const tr = document.createElement("tr");

      tr.innerHTML = `
        <td class="nr">${item.nr}</td>
        <td>${item.name}</td>
        <td class="right sizes">${item.karton}</td>
        <td class="right qty"><input inputmode="decimal" data-nr="${item.nr}" data-field="kartonQty" value="${state[item.nr].kartonQty ?? 0}"></td>
        <td class="right sizes">${item.beutel || 0}</td>
        <td class="right qty"><input inputmode="decimal" data-nr="${item.nr}" data-field="beutelQty" value="${state[item.nr].beutelQty ?? 0}"></td>
        <td class="right qty"><input inputmode="decimal" data-nr="${item.nr}" data-field="stueck" value="${state[item.nr].stueck ?? 0}"></td>
        <td class="gesamt" id="g-${item.nr}">${format(calcGesamt(item))}</td>
      `;
      tbody.appendChild(tr);
    }

    tbody.querySelectorAll("input").forEach(inp => {
      inp.addEventListener("input", (e) => {
        const nr = Number(e.target.dataset.nr);
        const field = e.target.dataset.field;
        state[nr][field] = e.target.value; // store raw (supports commas)
        saveState();

        const item = ITEMS.find(x => x.nr === nr);
        const g = document.getElementById(`g-${nr}`);
        if(item && g) g.textContent = format(calcGesamt(item));
      });
    });
  }

  function format(x){
    // show integers without decimals; decimals kept for 12.5 / 2.5 etc.
    const isInt = Math.abs(x - Math.round(x)) < 1e-9;
    return isInt ? String(Math.round(x)) : String(Math.round(x * 100) / 100);
  }

  document.getElementById("clear").addEventListener("click", () => {
    localStorage.removeItem(LS_KEY);
    for(const k of Object.keys(state)) delete state[k];
    render(search.value);
  });

  document.getElementById("reset").addEventListener("click", () => {
    for(const it of ITEMS){
      state[it.nr] = { kartonQty: 0, beutelQty: 0, stueck: 0 };
    }
    saveState();
    render(search.value);
  });

  search.addEventListener("input", () => render(search.value));

  render();
</script>
</body>
</html>
